<!-- Common -->
<template name="commonlayout">
    <div class="container-fluid">
        <div class="row">
            {{#with currentUser}}
            <div class="pull-right">
                <button id="back" class="btn btn-xs btn-default">
                    <span class="glyphicon glyphicon-menu-left"></span>
                </button>&nbsp;
                <a href="/teams" id="teamslink">
                    <img class="img-circle" src="/images/teams.png" width="36">
                </a>&nbsp;
                <a class="btn btn-default" href="/account" title="Manage account">
                    <span class="glyphicon glyphicon-user"></span>&nbsp;{{#with profile}}{{name}}{{/with}}
                </a>&nbsp;
                <button id="logoutb" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="bottom" title="Logout">
                    <span class="glyphicon glyphicon-log-out"></span>
                </button>
            </div>
            {{/with}}
        </div>
        <div class="row">
            {{> yield}}
        </div>
    </div>
</template>

<!-- Errors -->
<template name="notfound">
    <div class="panel panel-danger col-lg-6 col-lg-offset-3 mk-panel-error" role="alert">
        <div class="panel-body text-center">
            <h2>
                <span class="label label-danger">404</span>
            </h2>
            <h3 class="text-danger">Page Not found</h3>
        </div>
    </div>
</template>

<template name="accessdenied">
    <div class="panel panel-danger col-lg-6 col-lg-offset-3 mk-panel-error" role="alert">
        <div class="panel-body text-center">
            <h2>
                <span class="glyphicon glyphicon-minus-sign text-danger"></span>
            </h2>
            <h3 class="text-danger">Access denied</h3>
        </div>
    </div>
</template>

<!-- User management -->
<template name="account">
    <div class="col-sm-6 col-sm-offset-3">
        <div class="row">
            <div class="panel panel-info">
                <div class="panel-heading text-center">
                    <span class="panel-title">
                        <strong>Account Info</strong>
                    </span>
                </div>
                <div class="panel-body">
                    <div class="list-group">
                        {{#with currentUser}}
                        <span class="list-group-item">
                            <h5 class="text-muted">
                                <strong>Name / Email</strong>
                            </h5>
                            <h4>{{#with profile}}{{name}}{{/with}}
                                <span class="text-muted">&lt;{{username}}&gt;</span>
                            </h4>
                        </span>
                        {{/with}}
                        <span class="list-group-item">
                            <h5 class="text-muted">
                                <strong>Password</strong>
                            </h5>
                            <button id="changepassb" class="btn btn-danger">
                                <span class="glyphicon glyphicon-edit"></span>&nbsp;Change password
                            </button>
                            <div id="changePassPanel" hidden="true">
                                <br>
                                {{> quickForm schema="PasswordChangeSchema" id="changePasswordForm"}}
                                <div id="error" class="alert alert-danger" hidden="true"></div>
                                <div id="success" class="alert alert-success" hidden="true"></div>
                            </div>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="signup">
    <div class="panel panel-default col-sm-4 col-sm-offset-4" id="signupPanel">
        <div class="panel-body">
            <div class="row text-center">
                <img class="img-responsive center-block" src="/images/teams.png" alt="Teams Logo" width="150" height="150">
                <h3>Let's get started{{name}}</h3>
            </div>
            <div class="row">
                {{#autoForm schema="UserRegSchema" id="signupForm" type="method" meteormethod="signup"}}
                <fieldset>
                    <button type="reset" class="btn btn-link pull-right">
                        <span class="glyphicon glyphicon-refresh"></span>&nbsp;Reset
                    </button>
                    {{> afQuickField name="name" id="name" placeholder="Name" label=false class="input-lg"}} {{> afQuickField name="email" placeholder="Email" label=false class="input-lg"}} {{> afQuickField name="password" type="password" placeholder="Password" label=false
                    class="input-lg"}}
                    <button type="submit" class="btn btn-lg btn-primary btn-block">SIGN UP
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </button>
                </fieldset>
                <br>
                <div id="error" class="alert alert-danger" hidden="true"></div>
                {{/autoForm}}
            </div>
            <div class="text-center">
                <button id="login" class="btn btn-link">
                    <span class="glyphicon glyphicon-log-in"></span>&nbsp;&nbsp;Login with existing account
                </button>
            </div>
        </div>
    </div>
</template>

<template name="login">
    <div class="panel panel-default col-sm-4 col-sm-offset-4" id="loginPanel">
        <div class="panel-body">
            <div class="row text-center">
                <img src="/images/teams.png" alt="Teams Logo" width="150" height="150">
            </div>
            <div class="row">
                {{#autoForm schema="UserLoginSchema" id="loginForm"}}
                <fieldset>
                    <button type="reset" class="btn btn-link pull-right">
                        <span class="glyphicon glyphicon-refresh"></span>&nbsp;Reset
                    </button>
                    {{> afQuickField name="email" placeholder="Email address" label=false class="input-lg"}} {{> afQuickField name="password" type="password" placeholder="Password" label=false class="input-lg"}}
                </fieldset>
                <button type="submit" id="submit" class="btn btn-lg btn-primary btn-block">
                    <span class="glyphicon glyphicon-log-in"></span>&nbsp;&nbsp;LOGIN
                </button>
                <br>
                <div id="error" class="alert alert-danger" hidden="true"></div>
                {{/autoForm}}
            </div>
            <div class="text-center">
                <button id="signup" class="btn btn-default btn-link">
                    <span class="glyphicon glyphicon-plus"></span>&nbsp;Create Account
                </button>
            </div>
        </div>
    </div>
</template>

<!-- All Teams page -->

<template name="teams">
    <button id="createb" class="btn btn-success">
        <span class="glyphicon glyphicon-plus"></span>&nbsp;Create New Team
    </button>
    <br>
    <br>
    <div class="row">
        <div class="col-sm-5">
            <div id="createTeamPanel" hidden>
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <div class="panel-title">Create a new Team</div>
                    </div>
                    <div class="panel-body">
                        {{#autoForm collection="Teams" id="createTeamForm" type="method" meteormethod="createTeam"}}
                        <fieldset>
                            {{> afQuickField name="name"}}
                            <span class="text-info">
                                <strong>Enter email IDs of members separated by commas.</strong>
                                <br>
                                <em class="text-muted">You can add members later to your team as well</em>
                            </span>
                            <div class="input-group">
                                <span class="input-group-addon" id="mem-icon">@</span>
                                {{> afFieldInput name="members" id="members" aria-describedby="mem-icon"}}</div>
                            <div>
                                <br>
                                <button type="submit" class="btn btn-primary">Create
                                    <span class="glyphicon glyphicon-chevron-right"></span>
                                </button>
                                <button type="reset" class="btn btn-default">
                                    <span class="glyphicon glyphicon-refresh"></span>&nbsp;Reset</button>
                            </div>
                        </fieldset>
                        <br>
                        <div id="error" class="alert alert-danger" hidden="true"></div>
                        {{/autoForm}}
                    </div>
                </div>
            </div>
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">ADMIN OF</h3>
                </div>
                <div class="panel-body">
                    <div class="list-group">
                        {{#each adminteams}}
                        <a href="/t/{{_id}}" class="list-group-item">{{name}}
                            <span class="glyphicon glyphicon-chevron-right pull-right"></span>
                        </a>
                        {{else}}
                        <p class="list-group-item text-muted text-center">
                            <em>Not managing any teams yet</em>
                        </p>{{/each}}
                    </div>
                </div>
            </div>
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">MEMBER OF</h3>
                </div>
                <div class="panel-body">
                    <div class="list-group">
                        {{#each memteams}}
                        <a href="/t/{{_id}}" class="list-group-item">{{name}}
                            <span class="glyphicon glyphicon-chevron-right pull-right"></span>
                        </a>
                        {{else}}
                        <p class="list-group-item text-muted text-center">
                            <em>Not a part of any team yet</em>
                        </p>
                        {{/each}}
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-4 col-sm-offset-3">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title pull-left"><strong>Your Tasks</strong></h3><br>
                    <div class="btn-group btn-group-xs pull-right" data-toggle="buttons">
                        <label class="btn btn-default" disabled>
                            <span class="glyphicon glyphicon-sort-by-attributes pull-right sort-icon"></span>
                            <br>
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" id="sortByName" autocomplete="off" checked>Name</label>
                        <label class="btn btn-primary active">
                            <input type="radio" name="options" id="sortByDue" autocomplete="off">Due</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" id="sortByStatus" autocomplete="off">Status</label>
                    </div>
                    {{#if isNone pendingTasks}}
                    <div class="text-success pull-left animated bounceIn">✔︎ All tasks complete</div>
                    {{else}}
                    <div class="text-info pull-left animated flipInX">{{pendingTasks}}</div>
                    {{/if}}
                    <br>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-7">
                            <input type="text" class="form-control taskSearch" placeholder="Search">
                        </div>
                        <div class="col-sm-5">
                            <select class="searchType" placeholder="Scope">
                              <option value="name">Name</option> 
                              <option value="tags">Tags</option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <div class="list-group">
                        {{#each tasks}}
                        <div class="animated fadeInUp list-group-item {{status}}">
                            <label class="text-info">
                                <input type="checkbox" name="Mark as Complete" class="markTask" checked="{{status}}">&nbsp;
                                <strong>{{name}}</strong>
                            </label>
                            <button class="addNoteToTask btn btn-info btn-xs glyphicon glyphicon-list-alt pull-right" title="Add notes"></button>
                            <span class="pull-right">&nbsp;</span>
                            <a href="/t/{{teamID}}" title="{{assignedto}}" class="taskassignedto pull-right text-info" data-toggle="tooltip" data-placement="bottom">{{teamName}}</a>
                            <div id="notePanel-{{this._id}}" hidden="true">
                                <textarea class="form-control tasknotes" id=note-{{this._id}} name="notes" placeholder="Notes" aria-describedby="tag-icon" value={{this.notes}}></textarea>
                            </div>
                            <p class="text-muted">{{due}}</p>
                            {{#each tags}}
                            <span class="mk-token">{{this}}</span>
                            {{/each}}
                        </div>
                        {{/each}}
                    </div>
                    <div class="row text-center">
                    <button id="showArchived" class="btn-xs mk-btn">
                        <span class="glyphicon glyphicon-ok-sign"></span>&nbsp;Show Completed Tasks
                    </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>


<!-- Team page -->
<template name="teaminfo">
    <div class="col-sm-6 col-sm-offset-3">
        <div class="row">
            <div class="panel panel-info">
                <div class="panel-heading text-center">
                    <span class="panel-title">
                        <strong>Team Info</strong>
                    </span>
                </div>
                <div class="panel-body">
                    <div class="list-group">
                        <span class="list-group-item">
                            <h5 class="text-muted">
                                <strong>Name</strong>
                            </h5>
                            <h4>{{name}}</h4>
                        </span>
                        <span class="list-group-item">
                            <h5 class="text-muted">
                                <strong>Managed by</strong>
                            </h5>
                            <h4>{{showName admin}} <span class="text-muted">&lt;{{admin}}&gt;</span></h4>
                        </span>
                        <span class="list-group-item">
                            <h5 class="text-muted">
                                <strong>Members</strong>
                            </h5>
                            {{#if isAdmin}}
                            <button id="editb" class="btn btn-primary">
                                <span class="glyphicon glyphicon-pencil"></span>&nbsp;Edit members</button>
                            <br><br>
                            <div id="editMembersPanel" hidden>
                                {{#autoForm collection="Teams" doc=this id="updateMembersForm" type="update" autosave=true}} 
                                {{> afFormGroup name="members" id="members" label=false class="input-lg"}} 
                                {{/autoForm}}
                            </div>
                            {{/if}}
                            {{#each members}} 
                            <h4>{{showName this}}
                            <span class="text-muted">&lt;{{this}}&gt;</span></h4>
                            {{/each}}
                        </span>
                        {{#if isAdmin}}
                        <span class="list-group-item">
                            <h5 class="text-muted">
                                <strong>Delete Team</strong>
                            </h5>
                            <button class="btn btn-danger" data-toggle="modal" data-target="#deleteTeamModal">Delete Team</button>
                        </span>
                        <div id="deleteTeamModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true" aria-labelledby="deleteTeamModalLabel">
                          <div class="modal-dialog modal-md">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 id="deleteTeamModalLabel" class="text-danger modal-title">Are you sure you want to delete Team {{name}}?</h4>
                                </div>
                                <div class="modal-body">
                                    <p>
                                    Deleting team <strong>{{name}}</strong> will immediately remove all its associated data, including messages across all channels and conversations, tasks and shared files.
                                    </p>
                                </div>
                                <div class="modal-footer">
                                  <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                  <button id="delb" type="button" class="btn btn-danger">Confirm Deletion</button>
                                </div>
                            </div>
                          </div>
                        </div>
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="team">
    <h3 class="text-primary">{{name}}&nbsp;
        <button id="infob" class="btn btn-xs btn-primary" data-toggle="tooltip" data-placement="top" title="Team info"><span class="glyphicon glyphicon-info-sign"></span></button>
        <button id="filesb" class="btn btn-xs btn-primary" data-toggle="tooltip" data-placement="top" title="Shared files"><span class="glyphicon glyphicon-file"></span></button>
    </h3>
    <div class="row">
        <div class="col-md-8">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="list-group">
                                {{#if isAdmin}}
                                <div class="list-group-item">
                                    {{#autoForm collection="Channels" id="createChannelForm" type="insert"}} 										{{>afFormGroup name="name" placeholder="+ New Channel" label=false id="createChannel"}} 
                                    {{/autoForm}}
                                </div>
                                {{/if}} 
                                {{#each channels}}
                                <a id="{{_id}}" class="channelitem list-group-item">{{name}}               
                                    <span class="glyphicon glyphicon-chevron-right pull-right"></span>
                                    {{#if isAdmin}}
                                    <button class="delChannel btn btn-xs btn-danger pull-right glyphicon glyphicon-remove" data-toggle="tooltip" data-placement="left" title="Delete"></button>
                                    {{/if}}
                                </a>
                                {{/each}}
                                <hr>
                                <div class="list-group-item">
                                    <div class="row" id="createConv">
                                    {{#autoForm collection="Conversations" id="createConvForm" type="insert"}} 
                                    <div id="createConvMemList">
                                    {{>afFormGroup name="members" label=false type="selectize" multiple=true options=convMembers firstOption="Select members to chat with"}}
                                    </div>
                                    <button class="btn btn-success btn-sm glyphicon glyphicon-comment" type="submit" data-toggle="tooltip" title="Chat" id="chatb"></button>
                                    {{/autoForm}}
                                </div>
                                </div>
                                {{#each conversations}}
                                <a id="{{_id}}" class="convitem list-group-item">
                                    {{#each members}}
                                    	{{#if isCurrentUser}}
										{{else}}
											<span class="mk-token-user">{{showName this}}</span>
										{{/if}}
                                    {{/each}}
                                    	{{#if isInitiator}}
										{{else}}
											<span class="mk-token-user">{{showName owner}}</span>
										{{/if}}
                                    <span class="glyphicon glyphicon-chevron-right pull-right"></span>
                                    {{#if isInitiator}}
                                    	<button class="delConv btn btn-xs btn-danger pull-right glyphicon glyphicon-remove" data-toggle="tooltip" data-placement="left" title="Delete"></button>
                                    {{/if}}
                                </a>
                                {{/each}}
                            </div>
                        </div>
                        <div class="col-sm-8">
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    {{#if channel}} 
                                    {{#with channel}}
                                    <div class="row messageView" id="channelMsgView">
                                        <button class="loadMoreMsgs center-block mk-btn btn-xs" style="margin-bottom:5px">Load More</button>
                                        {{#each channelMessages}} 
                                        {{#if isSender}}
                                        <div class="bubblewrap">
                                        <div class="bubble-right animated bounceInRight">{{message}}
                                        </div>
                                        <div class="bubble-user-right animated bounceInRight" title="{{from}}">
                                            <span title="{{formatTimeAbsolute timestamp}}" class="timestamp">{{formatTimeRelative timestamp}}</span>
                                        </div>
                                        </div>
                                        {{else}}
                                        <div class="bubblewrap">
                                        <div class="bubble-left animated bounceInLeft">{{message}}
                                        </div>
                                        <div class="bubble-user-left animated bounceInLeft" title="{{from}}">
                                            <strong>{{showName from}}</strong>
                                            <span title="{{formatTimeAbsolute timestamp}}" class="timestamp">&lt;{{formatTimeRelative timestamp}}&gt;</span>
                                        </div>
                                        </div>
                                        {{/if}} 
                                        {{/each}}
                                    </div>
                                    <div class="row">
                                        {{#autoForm collection="Messages" id="createChannelMessageForm" type="insert"}} 
                                        	{{> afFormGroup name="message" label=false placeholder="Enter Message to send" class="inputMsg"}} 
                                        	<button class="msgb btn btn-primary" type="submit">Send</button>
                                        {{/autoForm}}
                                    </div>
                                    {{/with}} 
                                    {{else}} 
                                    {{#if conversation}} {{#with conversation}}
                                    <div class="memberBar">
                                        {{#each members}}
                                        {{#if isCurrentUser}}
                                        {{else}}
                                            <span title="{{this}}" class="mk-token-user">{{showName this}}</span>
                                        {{/if}}
                                    {{/each}}
                                        {{#if isInitiator}}
                                        {{else}}
                                            <span title="{{owner}}" class="mk-token-user">{{showName owner}}</span>
                                        {{/if}}
                                    </div>
                                    <div class="row messageView" id="convMsgView">
                                        <button class="loadMoreMsgs center-block mk-btn btn-xs" style="margin-bottom:5px">Load More</button>
                                        {{#each convMessages}} 
                                        {{#if isSender}}
                                        <div class="bubblewrap">
                                        <div class="bubble-right animated bounceInRight">{{message}}
                                        </div>
                                        <div class="bubble-user-right animated bounceInRight" title="{{from}}">
                                            <span title="{{formatTimeAbsolute timestamp}}" class="timestamp">{{formatTimeRelative timestamp}}</span>
                                        </div>
                                        </div>
                                        {{else}}
                                        <div class="bubblewrap">
                                        <div class="bubble-left animated bounceInLeft">{{message}}
                                        </div>
                                        <div class="bubble-user-left animated bounceInLeft" title="{{from}}">
                                            <strong>{{showName from}}</strong>
                                            <span title="{{formatTimeAbsolute timestamp}}" class="timestamp">&lt;{{formatTimeRelative timestamp}}&gt;</span>
                                        </div>
                                        </div>
                                        {{/if}} 
                                        {{/each}}
                                    </div>
                                    <div class="row">
                                        {{#autoForm collection="Messages" id="createConvMessageForm" type="insert"}}
                                        	{{> afFormGroup name="message" label=false placeholder="Enter Message to send" class="inputMsg"}}
                                        	<button class="msgb btn btn-primary" type="submit">Send</button>
                                        {{/autoForm}}
                                    </div>
                                    {{/with}} 
                                    {{else}}
	                                    <p class="text-muted text-center">
	                                        <strong>Select a channel/conversation</strong>
	                                    </p>
                                    {{/if}} 
                                    {{/if}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="row text-center">
                    <div class="statsPanel">
                    {{#if isNone pendingTasks}}
                    <div class="text-success animated bounceIn" style="display:inline-block">✔︎ All tasks complete</div>
                    {{else}}
                    <div class="text-info animated flipInX" style="display:inline-block">{{pendingTasks}}</div>                    &middot;

                    {{#if isNone yourPendingTasks}}
                    <div class="text-success animated bounceIn" style="display:inline-block">none yours ✔︎</div>
                    {{else}}
                    <div class="text-warning animated flipInX" style="display:inline-block">{{yourPendingTasks}}</div>
                    {{/if}}
                    {{/if}}
                    </div>
                    {{#if isAdmin}}
                    <button id="createtaskb" class="btn btn-success btn-xs" data-toggle="tooltip" title="Create New Task"><span class="glyphicon glyphicon-plus"></span></button>&nbsp;
                    {{/if}}
                    <div class="btn-group btn-group-xs" data-toggle="buttons">
                        <label class="btn btn-default" disabled>
                            <span class="glyphicon glyphicon-sort-by-attributes pull-right sort-icon"></span>
                            <br>
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" id="sortByName" autocomplete="off" checked>Name</label>
                        <label class="btn btn-primary active">
                            <input type="radio" name="options" id="sortByDue" autocomplete="off">Due</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" id="sortByAssigned" autocomplete="off">Assigned to</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" id="sortByStatus" autocomplete="off">Status</label>
                    </div>
                    <br>
                </div>
                <div class="panel-body">
                    {{#if isAdmin}}
                    <div class="panel panel-default" id="newTaskPanel" hidden>
                        <div class="panel-body">
                            {{#autoForm schema="TaskSchema" id="createTaskForm" type="method" meteormethod="createTask"}}
                                {{> afFormGroup name="name" placeholder="schemaLabel" label=false}} 
                                {{> afFormGroup name="assignedto" type="selectize" label=false options=teamMembers firstOption="Select a member to assign this task to :" class="assignedto"}}
                                <div class="input-group">
                                    <span class="input-group-addon" id="time-icon">
                                        <span class="glyphicon glyphicon-time"></span>
                                    </span>
                                    {{> afFieldInput name="due" placeholder="Due Date" class="taskduedate" label=false aria-describedby="time-icon"}}
                                </div>

                                <br>
                                <div class="input-group">
                                    <span class="input-group-addon" id="icon">
                                        <span class="glyphicon glyphicon-tag"></span>
                                    </span>
                                    {{> afFieldInput name="tags" label=false id="tasktags" placeholder="Tags" aria-describedby="tag-icon"}}</div>
                            <div>
                                <br>
                                <button type="submit" class="btn btn-sm btn-primary">
                                    <span class="glyphicon glyphicon-ok"></span>&nbsp;Add Task
                                </button>
                                <button type="reset" class="btn btn-sm btn-default">
                                    <span class="glyphicon glyphicon-refresh"></span>&nbsp;Reset</button>
                            </div>
                            {{/autoForm}}
                        </div>
                    </div>
                    {{/if}}
                    <div class="row">
                        <div class="col-sm-7">
                            <input type="text" class="form-control taskSearch" placeholder="Search">
                        </div>
                        <div class="col-sm-5">
                            <select class="searchType" placeholder="Scope">
                              <option value="name">Name</option> 
                              <option value="tags">Tags</option>
                              <option value="assignedto">Assigned to</option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <div class="list-group" id="tasksPanel">
                        {{#each tasks}}
                        <div class="animated fadeInUp list-group-item {{status}}">
                            <label class="text-info">
                                {{#if ownsTask}}
                                <input type="checkbox" name="Mark as Complete" class="markTask" checked="{{status}}">{{else}}
                                <input type="checkbox" name="Status" class="markTask animated fadeInLeft" checked="{{status}}" disabled="disabled">{{/if}}&nbsp;
                                <strong>{{name}}</strong>
                            </label>
                            {{#if ownsTask}}
                            <button class="addNoteToTask btn btn-info btn-xs glyphicon glyphicon-list-alt pull-right" title="Add notes"></button>
                            {{/if}}
                            <span class="pull-right">&nbsp;&nbsp;</span>
                            <a title="{{assignedto}}" class="taskassignedto pull-right text-info" data-toggle="tooltip" data-placement="bottom">{{showName assignedto}}</a>
                            {{#if ownsTask}}
                            <div id="notePanel-{{this._id}}" hidden="true">
                            <textarea class="form-control tasknotes" id=note-{{this._id}} name="notes" placeholder="Notes" aria-describedby="tag-icon" value={{this.notes}}></textarea>
                            </div>
                            {{/if}}
                            <p class="text-muted">{{due}}</p>
                            {{#each tags}}
                            <span class="mk-token">{{this}}</span>
                            {{/each}} 
                            {{#if isAdmin}}
                            <button class="delTask btn btn-danger btn-xs glyphicon glyphicon-trash pull-right" data-toggle="tooltip" title="Delete">
                            </button>
                            <span class="pull-right">&nbsp;</span>
                            <button class="editTask btn btn-warning btn-xs glyphicon glyphicon-pencil pull-right" title="Edit Task" data-toggle="button"></button>
                            <br>
                            <br>
                            <div id={{this._id}} class="panel panel-default editTaskPanel" hidden>
                                <div class="panel-body">
                                    {{#autoForm schema="TaskSchema" doc=this id=this._id type="method" meteormethod="updateTask"}}
                                    <fieldset>
                                        {{> afFormGroup name="name" placeholder="schemaLabel" label=false}}                     
                                        {{> afFormGroup name="assignedto" type="selectize" label=false options=teamMembers}}
                                        <div class="input-group">
                                            <span class="input-group-addon" id="time-icon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                            {{> afFieldInput name="due" placeholder="Due Date" class="taskduedate" label=false aria-describedby="time-icon"}}
                                        </div>
                                        <br>
                                        <div class="input-group">
                                            <span class="input-group-addon" id="tag-icon">
                                                <span class="glyphicon glyphicon-tag"></span>
                                            </span>
                                            {{> afFieldInput name="tags" label=false class="tasktags" placeholder="Tags" aria-describedby="tag-icon"}}</div>
                                        <div hidden="hidden">
                                            {{> afFieldInput name="_id"}} 
                                            {{> afFieldInput name="teamID"}}
                                        </div>
                                    </fieldset>
                                    <div>
                                        <br>
                                        <button type="submit" class="btn btn-sm btn-primary">
                                            <span class="glyphicon glyphicon-ok"></span>&nbsp;Save changes
                                        </button>
                                    </div>
                                    {{/autoForm}}
                                </div>
                            </div>
                            {{/if}}
                        </div>
                        {{/each}}
                    </div>
                    <div class="row text-center">
                    <button id="showArchived" class="btn-xs mk-btn">
                        <span class="glyphicon glyphicon-ok-sign"></span>&nbsp;Show Completed Tasks
                    </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="teamfiles">
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel panel-body">
                <button id="uploadb" class="btn btn-success">
                    <span class="glyphicon glyphicon-plus"></span>&nbsp;Upload File
                </button>
                <div class="uploadFilePanel">
                    {{#autoForm schema="TeamFilesSchema" type="method"}}
                        {{>afQuickField name="files"}}
                        <button type="submit" class="btn btn-primary btn-xs">Upload</button>
                    {{/autoForm}}
                </div>
                <br>
                <div class="list-group">
                {{#each teamFiles}}
                    <div class="list-group-item">
                        <img class="img-circle" src="{{this.url}}" width="100">
                    </div>
                {{/each}}
                </div>
            </div>
        </div>
    </div>
</template>
